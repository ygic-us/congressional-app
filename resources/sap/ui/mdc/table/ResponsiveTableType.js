/*
 * ! OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Core","./TableTypeBase","../library","sap/m/Button","sap/ui/Device"],function(C,T,l,B,D){"use strict";var I,a,b;var G=l.GrowingMode;var R=l.RowAction;var c=T.extend("sap.ui.mdc.table.ResponsiveTableType",{metadata:{properties:{growingMode:{type:"sap.ui.mdc.GrowingMode",defaultValue:G.Basic},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false}}}});c.prototype.updateRelevantTableProperty=function(t,p,v){if(t&&t.isA("sap.m.Table")){if(p==="growingMode"){t.setGrowingScrollToLoad(v===G.Scroll);t.setGrowing(v!==G.None);}else if(p==="showDetailsButton"){this.updateShowDetailsButton(t,v);}}};c.updateDefault=function(t){if(t){t.setGrowing(true);t.setGrowingScrollToLoad(false);}};c.prototype.updateShowDetailsButton=function(t,v){if(v&&!this._oShowDetailsButton){t.getHeaderToolbar().insertEnd(this._getShowDetailsButton(),0);this._renderShowDetailsButton();t.attachEvent("popinChanged",this._onPopinChanged,this);t.setHiddenInPopin(D.system.phone?["Low","Medium"]:["Low"]);}else if(!v&&this._oShowDetailsButton){t.detachEvent("popinChanged",this._onPopinChanged,this);t.getHeaderToolbar().removeEnd(this._oShowDetailsButton);t.setHiddenInPopin([]);this._oShowDetailsButton.destroy();delete this._oShowDetailsButton;}};c.loadTableModules=function(){if(!I){return new Promise(function(r,d){sap.ui.require(["sap/m/Table","sap/m/Column","sap/m/ColumnListItem"],function(e,f,g){I=e;a=f;b=g;r();},function(){d("Failed to load some modules");});});}else{return Promise.resolve();}};c.createTable=function(i,s){return new I(i,s);};c.createColumn=function(i,s){return new a(i,s);};c.createTemplate=function(i,s){return new b(i,s);};c.updateSelection=function(t){t._oTable.setMode(T.getSelectionMode(t));};c.updateNavigation=function(t){t._oTemplate.setType(R.Navigation);};c.updateRowAction=function(t,n){var s=t.hasListeners("rowPress")?"Active":"Inactive";t._oTemplate.setType(s);if(n){this.updateNavigation(t);}};c.updateRowSettings=function(r,o){r.unbindProperty("navigated");r.unbindProperty("highlight");r.unbindProperty("highlightText");r.applySettings(o.getAllSettings());};c.prototype._renderShowDetailsButton=function(){var r=C.getLibraryResourceBundle("sap.ui.mdc"),t;t=this.bHideDetails?r.getText("table.SHOWDETAILS_TEXT"):r.getText("table.HIDEDETAILS_TEXT");this._oShowDetailsButton.setTooltip(t);this._oShowDetailsButton.setText(t);};c.prototype._toggleShowDetails=function(v){if(!this._oShowDetailsButton||(v===this.bHideDetails)){return;}var t=this.getRelevantTable();this.bHideDetails=v;this.bHideDetails?t.setHiddenInPopin(["Low"]):t.setHiddenInPopin([]);this._renderShowDetailsButton();};c.prototype._getShowDetailsButton=function(){if(!this._oShowDetailsButton){this.bHideDetails=true;this._oShowDetailsButton=new B(this.getId()+"-showHideDetails",{visible:false,press:[function(){this._toggleShowDetails(!this.bHideDetails);},this]});}return this._oShowDetailsButton;};c.prototype._onPopinChanged=function(e){var h=e.getParameter("hasPopin");var H=e.getParameter("hiddenInPopin");if(H.length||(h&&!this.bHideDetails)){this._oShowDetailsButton.setVisible(true);}else{this._oShowDetailsButton.setVisible(false);}};return c;});
