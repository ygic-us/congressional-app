/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/dnd/DragInfo','sap/ui/core/dnd/DropInfo',"sap/ui/events/KeyCodes",'sap/ui/core/dnd/DropPosition'],function(D,a,K,b){"use strict";var I="Before",c="insertBefore",d="insertAfter",i,e="IconTabReorder",f="Forward",g="Backward";var h={_insertControl:function(i,o,j,k){var $=o.$(),l=j.$(),m=[],n=[];if(o._getNestedLevel()>1&&j._getNestedLevel()>1){m=o._getRootTab()._getSelectList().getItems().filter(function(p){return o._getRealTab()._isParentOf(p._getRealTab());});n=j._getRootTab()._getSelectList().getItems().filter(function(p){return j._getRealTab()._isParentOf(p._getRealTab());});}if(k){var O=o._getRootTab().getParent()._getOverflow()._getSelectList().getItems();m=O.filter(function(p){return o._getRealTab()._isParentOf(p._getRealTab());});n=O.filter(function(p){return j._getRealTab()._isParentOf(p._getRealTab());});}if(i===d){$.insertAfter(l);}else{$.insertBefore(l);}m.reverse().forEach(function(C){C.$().insertAfter($);});n.reverse().forEach(function(C){C.$().insertAfter(l);});},handleDrop:function(C,s,o,j,k,l){var B=C.indexOfItem(o),m=C.indexOfItem(j),A=0,r=sap.ui.getCore().getConfiguration().getRTL(),n=s===I,p=j._getNestedLevel()-1;if(o._isParentOf(j)){return;}if(p===l&&s===b.On){return;}if(r&&!k){if(n){A=B<m?m:m+1;i=d;}else{A=B<m?m-1:m;i=c;}}else{if(n){A=B<m?m-1:m;i=c;}else{A=B<m?m:m+1;i=d;}}if(C.isA("sap.m.IconTabFilter")||!o.getParent().isA("sap.m.IconTabHeader")){if(n){A=m;}else{A=m+1;}}h._insertControl(i,o,j);if(s===b.On){if(j===o){return;}A=C.getAggregation("items").length;}h._handleConfigurationAfterDragAndDrop.call(C,o,A);},_updateAccessibilityInfo:function(){var o=this.getItems(),A=1,j;o.forEach(function(k){j=k.getDomRef();if(j&&j.getAttribute("aria-posinset")!==null){j.setAttribute("aria-posinset",A++);}});},_handleConfigurationAfterDragAndDrop:function(o,j){var k=[];if(this.isA("sap.m.IconTabBarSelectList")){k=this.getItems().filter(function(l){return o._getRealTab()._isParentOf(l._getRealTab());});}this.removeAggregation('items',o,true);this.insertAggregation('items',o,j,true);k.forEach(function(l){this.removeAggregation('items',l,true);}.bind(this));var n=1+this.indexOfAggregation('items',o);k.reverse().forEach(function(l){this.insertAggregation('items',l,n,true);}.bind(this));h._updateAccessibilityInfo.call(this);},_decreaseDropIndex:function(B,j){var p=B-1;while(p>=0&&(j[B]._getRealTab()._getNestedLevel()!==j[p]._getRealTab()._getNestedLevel()||!j[p].getVisible()||(!j[B].$().hasClass("sapMITBFilterHidden")&&j[p].$().hasClass("sapMITBFilterHidden")))){p--;}if(p<0){i=d;return B;}i=c;return p;},_increaseDropIndex:function(B,j,m){var n=B+1;while(n<j.length&&(j[B]._getRealTab()._getNestedLevel()!==j[n]._getRealTab()._getNestedLevel()||!j[n].getVisible())){n++;}if(n>m){i=c;return B;}i=d;return n;},moveItem:function(o,k,m){var j=this.getItems(),B=this.indexOfItem(o),r=sap.ui.getCore().getConfiguration().getRTL(),n,p;if(this.isA("sap.m.IconTabFilter")){j=this._getRealTab().getItems();}switch(k){case K.HOME:n=0;i=c;break;case K.END:n=j.length-1;i=d;break;case K.ARROW_LEFT:if(r){p=h.preventDragBetweenSubItems(o,f,this);n=h._increaseDropIndex(B,j,m);}else{p=h.preventDragBetweenSubItems(o,g,this);n=h._decreaseDropIndex(B,j);}break;case K.ARROW_RIGHT:if(r){p=h.preventDragBetweenSubItems(o,g,this);n=h._decreaseDropIndex(B,j);}else{p=h.preventDragBetweenSubItems(o,f,this);n=h._increaseDropIndex(B,j,m);}break;case K.ARROW_DOWN:p=h.preventDragBetweenSubItems(o,f,this);n=h._increaseDropIndex(B,j,m);break;case K.ARROW_UP:p=h.preventDragBetweenSubItems(o,g,this);n=h._decreaseDropIndex(B,j);break;default:return false;}if(p){return false;}if(!this.isA("sap.m.IconTabFilter")){var l=j[n];h._insertControl(i,o,l,this._oTabFilter&&this._oTabFilter._bIsOverflow);}h._handleConfigurationAfterDragAndDrop.call(this,o,n);return true;},setDragDropAggregations:function(j,s,o){var k=j._oIconTabHeader?j._oIconTabHeader:j;var l=k.getId();j.addDragDropConfig(new D({sourceAggregation:"items",groupName:e+l}));j.addDragDropConfig(new a({targetAggregation:"items",dropPosition:o,dropLayout:s,drop:j._handleDragAndDrop.bind(j),groupName:e+l}));},preventDragBetweenSubItems:function(o,s,C){var p=false;if(C.isA("sap.m.IconTabBarSelectList")){var r=o._getRealTab(),P=r.getParent(),j=P.getItems();if((j.indexOf(r)===0&&s===g)||(j.indexOf(r)+1===j.length&&s===f)||j.length===1){p=true;}}return p;}};return h;});
